{
  "version": 8,
  "configurePresets": [
    {
      "name": "ci-sibling-build",
      "hidden": true,
      "description": "Sibling build",
      "binaryDir": "${sourceParentDir}/${sourceDirName}-build"
    },
    {
      "name": "ci-subdirectory-build",
      "hidden": true,
      "description": "Subdirectory build",
      "binaryDir": "build"
    },
    {
      "name": "ci-pch",
      "description": "Use PCH",
      "hidden": true,
      "cacheVariables": {
        // Determined via clang-trace
        "SRCML_CLIENT_PCH": "<srcml_cli.hpp>;<srcml_input_src.hpp>;<srcml_pipe.hpp>;<ParseQueue.hpp>;<src_input_libarchive.hpp>;<SRCMLStatus.hpp>;<WriteQueue.hpp>;<ParseRequest.hpp>;<TraceLog.hpp>;<curl/curl.h>",
        "SRCML_LIBSRCML_PCH": "<srcmlns.hpp>;<srcml_types.hpp>;<srcml_sax2_utilities.hpp>;<srcml_translator.hpp>;<srcml_sax2_reader.hpp>",
        "SRCML_PARSER_PCH": "<srcMLParser.hpp> <CommentTextLexer.hpp> <ModeStack.hpp> <Language.hpp> <UTF8CharBuffer.hpp>"
      }
    },
    {
      "name": "ci-vcpkg",
      "hidden": true,
      "toolchainFile": "$env{VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake"
    },
    {
      "name": "ci-ccache",
      "hidden": true,
      "description": "ccache setup",
      "cacheVariables": {
        "CMAKE_CXX_COMPILER_LAUNCHER": "ON"
      }
    },
    {
      "name": "ci-linux",
      "description": "Default build options for Linux",
      "hidden": true,
      "generator": "Ninja",
      "cacheVariables": {
        "CMAKE_CXX_FLAGS": "-Wall -Wextra -pedantic",
        // "CMAKE_INTERPROCEDURAL_OPTIMIZATION": "ON",
        "SRCML_ANTLR_DISABLED_WARNINGS": "-Wno-format;-Wno-misleading-indentation;-Wno-deprecated-declarations",
        "SRCML_PARSER_DISABLED_WARNINGS": "-Wno-unused-but-set-variable"
      }
    },
    {
      "name": "ci-gcc",
      "hidden": true,
      "inherits": ["ci-linux"],
      "displayName": "GCC",
      "description": "Default build options for GCC",
      "toolchainFile": "toolchain-gcc.cmake",
      "cacheVariables": {
        "SRCML_LIBSRCML_LINK_FLAGS": "-Wl,--version-script=${sourceDir}/src/libsrcml/libsrcml.version",
        "CMAKE_BUILD_TYPE": "Release"
      }
    }
  ],
  "buildPresets": [
    {
      "name": "ci-parser-tests",
      "hidden": true,
      "targets": ["gen_parser_tests","run_parser_tests"]
    },
    {
      "name": "ci-install-package",
      "hidden": true,
      "targets": "install_package"
    }
  ],
  "packagePresets": [
    {
      "name": "ci-base",
      "hidden": true,
      "configurations": [ "Release" ],
      "generators": [ "TGZ", "TBZ2" ],
      "packageDirectory": "dist"
    }
  ],
  "testPresets": [
    {
      "name": "ci-client",
      "hidden": true,
      "execution": {
        "jobs": 8,
        "timeout": 15
      },
      "filter": {
        "include": {
            "name": "^srcml[.]"
        }
      },
      "output": {
        "verbosity": "extra",
        "outputLogFile": "/Builds/$env{FILENAME}_ctest.log"
      }
    },
    {
      "name": "ci-libsrcml",
      "hidden": true,
      "execution": {
        "jobs": 8,
        "timeout": 10
      },
      "filter": {
        "include": {
            "name": "^libsrcml[.]"
        }
      },
      "output": {
        "outputLogFile": "/Builds/$env{FILENAME}_libsrcml_ctest.log"
      }
    }
  ]
}
